import numpy as np

z = np.array([
    [-1604.0537, -951.3475, 418.43823, 790.98474, -1883.7557, -1859.09, -4021.8716, 3684.7974, -1176.6866, -218.82979],
    [-121.82654, 563.2724, 4425.9033, 163.68532, -2488.3696, -1518.7434, -1866.1082, -1781.7941, -831.22375, -3104.8926]
])

z_max = np.max(z)
exp_z = np.exp(z - z_max)  # 减去z中的最大值以避免溢出
a_out = exp_z / np.sum(exp_z)

print(a_out)
